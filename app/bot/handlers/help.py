from aiogram import Router, types
from aiogram.filters import Command

from bot.keyboards import main_menu_kb
from services.user_settings import get_user_settings

router = Router()

HELP_TEXT = (
    "<b>–ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –±–æ—Ç–æ–º</b>\n\n"
    "<b>1. –°–º–µ–Ω–∞ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞</b>\n"
    "–ö–æ–º–∞–Ω–¥–∞: <code>/symbol BTCUSDT</code>\n"
    "–ü—Ä–∏–º–µ—Ä—ã:\n"
    "‚Ä¢ <code>/symbol BTCUSDT</code>\n"
    "‚Ä¢ <code>/symbol ETHUSDT</code>\n"
    "‚Ä¢ <code>/symbol SOLUSDT</code>\n\n"
    "–ü–æ—Å–ª–µ —Å–º–µ–Ω—ã —Å–∏–º–≤–æ–ª–∞ –≤—Å–µ –≤–∏–¥—ã –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –±—É–¥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –ø–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –ø–∞—Ä–µ.\n\n"
    "<b>2. –í—ã–±–æ—Ä —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞</b>\n"
    "–ò—Å–ø–æ–ª—å–∑—É–π –∫–Ω–æ–ø–∫–∏ –≤–Ω–∏–∑—É:\n"
    "‚Ä¢ ‚è± 1h ‚Äî —á–∞—Å–æ–≤—ã–µ —Å–≤–µ—á–∏\n"
    "‚Ä¢ ‚è± 4h ‚Äî —á–µ—Ç—ã—Ä—ë—Ö—á–∞—Å–æ–≤—ã–µ\n"
    "‚Ä¢ ‚è± 1d ‚Äî –¥–Ω–µ–≤–Ω—ã–µ\n\n"
    "<b>3. –í—ã–±–æ—Ä –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–≤–µ—á–µ–π</b>\n"
    "–ö–Ω–æ–ø–∫–∏:\n"
    "‚Ä¢ 100 üïØ ‚Äî –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å–≤–µ—á–µ–π\n"
    "‚Ä¢ 200 üïØ ‚Äî –ø–æ—Å–ª–µ–¥–Ω–∏–µ 200 —Å–≤–µ—á–µ–π\n"
    "‚Ä¢ 500 üïØ ‚Äî –ø–æ—Å–ª–µ–¥–Ω–∏–µ 500 —Å–≤–µ—á–µ–π\n\n"
    "<b>4. –ö–Ω–æ–ø–∫–∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏</b>\n"
    "‚Ä¢ üìä –°–≤–µ—á–∏ ‚Äî —Ç—Ä–µ–Ω–¥, —É—Ä–æ–≤–Ω–∏, –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å, RSI, MACD\n"
    "‚Ä¢ üìò –°—Ç–∞–∫–∞–Ω ‚Äî –¥–∏—Å–±–∞–ª–∞–Ω—Å Bid/Ask –∏ –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å\n"
    "‚Ä¢ üìà –û–±—ä—ë–º ‚Äî –¥–µ–ª—å—Ç–∞ –ø–æ–∫—É–ø–æ–∫/–ø—Ä–æ–¥–∞–∂ (taker buy/sell)\n"
    "‚Ä¢ ‚öôÔ∏è –§—å—é—á–∏ ‚Äî funding rate –∏ –æ—Ç–∫—Ä—ã—Ç—ã–π –∏–Ω—Ç–µ—Ä–µ—Å (OI)\n"
    "‚Ä¢ üîó –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ ‚Äî —Å–≤—è–∑—å —Å BTC –∏ ETH –ø–æ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏\n"
    "‚Ä¢ üßæ –ü–æ–ª–Ω—ã–π –æ—Ç—á—ë—Ç ‚Äî –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤—Å–µ –≤–∏–¥—ã –∞–Ω–∞–ª–∏—Ç–∏–∫–∏\n\n"
    "–ë–æ—Ç –∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—Ç–¥–µ–ª—å–Ω–æ:\n"
    "‚Äî –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Å–∏–º–≤–æ–ª\n"
    "‚Äî —Ç–∞–π–º—Ñ—Ä–µ–π–º\n"
    "‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–µ–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞.\n"
)

@router.message(Command("help"))
async def cmd_help(message: types.Message):
    settings = get_user_settings(message.chat.id)
    prefix = (
        f"–¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:\n"
        f"‚Ä¢ –°–∏–º–≤–æ–ª: <b>{settings.symbol}</b>\n"
        f"‚Ä¢ –¢–∞–π–º—Ñ—Ä–µ–π–º: <b>{settings.interval}</b>\n"
        f"‚Ä¢ –°–≤–µ—á–µ–π: <b>{settings.candles_limit}</b>\n\n"
    )
    await message.answer(prefix + HELP_TEXT, reply_markup=main_menu_kb())
